
<style>
  #controls {
    color:white;
  }
  #coords {
    position:absolute;
    bottom:0px;
    right:0px;
    z-index:1000;
    background-color:white;
    color:black;
    padding:0px 5px;
  }
  #controls img {
    -moz-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: FlipH;
    -ms-filter: "FlipH";
  }
  #controls img:hover {
    cursor:pointer;
    cursor:hand;
  }
  #controls-max {
    display:none;
  }
  #controlslist {
    font-family:sans-serif;
    font-weight:bold;
    font-size:smaller;
    list-style:none;
    margin:0px;
    padding:5px 10px 5px 25px;
  }
  #output {
    padding:5px 10px 5px 25px;
  }
  #controlslist li{
    padding:0px 5px;
  }


  div.olMap {
    z-index: 0;
    padding: 0 !important;
    margin: 0 !important;
    cursor: default;
  }

  div.olMapViewport {
    text-align: left;
    -ms-touch-action: none;
  }

  div.olLayerDiv {
    -moz-user-select: none;
    -khtml-user-select: none;
  }

  .olLayerGoogleCopyright {
    left: 2px;
    bottom: 2px;
  }
  .olLayerGoogleV3.olLayerGoogleCopyright {
    right: auto !important;
  }
  .olLayerGooglePoweredBy {
    left: 2px;
    bottom: 15px;
  }
  .olLayerGoogleV3.olLayerGooglePoweredBy {
    bottom: 15px !important;
  }
  /* GMaps should not set styles on its container */
  .olForeignContainer {
    opacity: 1 !important;
  }
  .olControlAttribution {
    font-size: smaller;
    right: 3px;
    bottom: 4.5em;
    position: absolute;
    display: block;
  }
  .olControlScale {
    right: 3px;
    bottom: 3em;
    display: block;
    position: absolute;
    font-size: smaller;
  }
  .olControlScaleLine {
    display: block;
    position: absolute;
    left: 10px;
    bottom: 15px;
    font-size: xx-small;
  }
  .olControlScaleLineBottom {
    border: solid 2px black;
    border-bottom: none;
    margin-top:-2px;
    text-align: center;
  }
  .olControlScaleLineTop {
    border: solid 2px black;
    border-top: none;
    text-align: center;
  }

  .olControlPermalink {
    right: 3px;
    bottom: 1.5em;
    display: block;
    position: absolute;
    font-size: smaller;
  }

  div.olControlMousePosition {
    bottom: 0;
    right: 3px;
    display: block;
    position: absolute;
    font-family: Arial;
    font-size: smaller;
  }

  .olControlOverviewMapContainer {
    position: absolute;
    bottom: 0;
    right: 0;
  }

  .olControlOverviewMapElement {
    padding: 10px 18px 10px 10px;
    background-color: #00008B;
    -moz-border-radius: 1em 0 0 0;
  }

  .olControlOverviewMapMinimizeButton,
  .olControlOverviewMapMaximizeButton {
    height: 18px;
    width: 18px;
    right: 0;
    bottom: 80px;
    cursor: pointer;
  }

  .olControlOverviewMapExtentRectangle {
    overflow: hidden;
    background-image: url("img/blank.gif");
    cursor: move;
    border: 2px dotted red;
  }
  .olControlOverviewMapRectReplacement {
    overflow: hidden;
    cursor: move;
    background-image: url("img/overview_replacement.gif");
    background-repeat: no-repeat;
    background-position: center;
  }

  .olLayerGeoRSSDescription {
    float:left;
    width:100%;
    overflow:auto;
    font-size:1.0em;
  }
  .olLayerGeoRSSClose {
    float:right;
    color:gray;
    font-size:1.2em;
    margin-right:6px;
    font-family:sans-serif;
  }
  .olLayerGeoRSSTitle {
    float:left;font-size:1.2em;
  }

  .olPopupContent {
    padding:5px;
    overflow: auto;
  }

  .olControlNavigationHistory {
    background-image: url("img/navigation_history.png");
    background-repeat: no-repeat;
    width:  24px;
    height: 24px;

  }
  .olControlNavigationHistoryPreviousItemActive {
    background-position: 0 0;
  }
  .olControlNavigationHistoryPreviousItemInactive {
    background-position: 0 -24px;
  }
  .olControlNavigationHistoryNextItemActive {
    background-position: -24px 0;
  }
  .olControlNavigationHistoryNextItemInactive {
    background-position: -24px -24px;
  }

  div.olControlSaveFeaturesItemActive {
    background-image: url(img/save_features_on.png);
    background-repeat: no-repeat;
    background-position: 0 1px;
  }
  div.olControlSaveFeaturesItemInactive {
    background-image: url(img/save_features_off.png);
    background-repeat: no-repeat;
    background-position: 0 1px;
  }

  .olHandlerBoxZoomBox {
    border: 2px solid red;
    position: absolute;
    background-color: white;
    opacity: 0.50;
    font-size: 1px;
    filter: alpha(opacity=50);
  }
  .olHandlerBoxSelectFeature {
    border: 2px solid blue;
    position: absolute;
    background-color: white;
    opacity: 0.50;
    font-size: 1px;
    filter: alpha(opacity=50);
  }

  .olControlPanPanel {
    top: 10px;
    left: 5px;
  }

  .olControlPanPanel div {
    background-image: url(img/pan-panel.png);
    height: 18px;
    width: 18px;
    cursor: pointer;
    position: absolute;
  }

  .olControlPanPanel .olControlPanNorthItemInactive {
    top: 0;
    left: 9px;
    background-position: 0 0;
  }
  .olControlPanPanel .olControlPanSouthItemInactive {
    top: 36px;
    left: 9px;
    background-position: 18px 0;
  }
  .olControlPanPanel .olControlPanWestItemInactive {
    position: absolute;
    top: 18px;
    left: 0;
    background-position: 0 18px;
  }
  .olControlPanPanel .olControlPanEastItemInactive {
    top: 18px;
    left: 18px;
    background-position: 18px 18px;
  }

  .olControlZoomPanel {
    top: 71px;
    left: 14px;
  }

  .olControlZoomPanel div {
    background-image: url(img/zoom-panel.png);
    position: absolute;
    height: 18px;
    width: 18px;
    cursor: pointer;
  }

  .olControlZoomPanel .olControlZoomInItemInactive {
    top: 0;
    left: 0;
    background-position: 0 0;
  }

  .olControlZoomPanel .olControlZoomToMaxExtentItemInactive {
    top: 18px;
    left: 0;
    background-position: 0 -18px;
  }

  .olControlZoomPanel .olControlZoomOutItemInactive {
    top: 36px;
    left: 0;
    background-position: 0 18px;
  }

  /*
   * When a potential text is bigger than the image it move the image
   * with some headers (closes #3154)
   */
  .olControlPanZoomBar div {
    font-size: 1px;
  }

  .olPopupCloseBox {
    background: url("img/close.gif") no-repeat;
    cursor: pointer;
  }

  .olFramedCloudPopupContent {
    padding: 5px;
    overflow: auto;
  }

  .olControlNoSelect {
    -moz-user-select: none;
    -khtml-user-select: none;
  }

  .olImageLoadError {
    background-color: pink;
    opacity: 0.5;
    filter: alpha(opacity=50); /* IE */
  }

  /**
   * Cursor styles
   */

  .olCursorWait {
    cursor: wait;
  }
  .olDragDown {
    cursor: move;
  }
  .olDrawBox {
    cursor: crosshair;
  }
  .olControlDragFeatureOver {
    cursor: move;
  }
  .olControlDragFeatureActive.olControlDragFeatureOver.olDragDown {
    cursor: -moz-grabbing;
  }

  /**
   * Layer switcher
   */
  .olControlLayerSwitcher {
    position: absolute;
    top: 25px;
    right: 0;
    width: 20em;
    font-family: sans-serif;
    font-weight: bold;
    margin-top: 3px;
    margin-left: 3px;
    margin-bottom: 3px;
    font-size: smaller;
    color: white;
    background-color: transparent;
  }

  .olControlLayerSwitcher .layersDiv {
    padding-top: 5px;
    padding-left: 10px;
    padding-bottom: 5px;
    padding-right: 10px;
    background-color: darkblue;
  }

  .olControlLayerSwitcher .layersDiv .baseLbl,
  .olControlLayerSwitcher .layersDiv .dataLbl {
    margin-top: 3px;
    margin-left: 3px;
    margin-bottom: 3px;
  }

  .olControlLayerSwitcher .layersDiv .baseLayersDiv,
  .olControlLayerSwitcher .layersDiv .dataLayersDiv {
    padding-left: 10px;
  }

  .olControlLayerSwitcher .maximizeDiv,
  .olControlLayerSwitcher .minimizeDiv {
    width: 18px;
    height: 18px;
    top: 5px;
    right: 0;
    cursor: pointer;
  }

  .olBingAttribution {
    color: #DDD;
  }
  .olBingAttribution.road {
    color: #333;
  }

  .olGoogleAttribution.hybrid, .olGoogleAttribution.satellite {
    color: #EEE;
  }
  .olGoogleAttribution {
    color: #333;
  }
  span.olGoogleAttribution a {
    color: #77C;
  }
  span.olGoogleAttribution.hybrid a, span.olGoogleAttribution.satellite a {
    color: #EEE;
  }

  /**
   * Editing and navigation icons.
   * (using the editing_tool_bar.png sprint image)
   */
  .olControlNavToolbar ,
  .olControlEditingToolbar {
    margin: 5px 5px 0 0;
  }
  .olControlNavToolbar div,
  .olControlEditingToolbar div {
    background-image: url("img/editing_tool_bar.png");
    background-repeat: no-repeat;
    margin: 0 0 5px 5px;
    width: 24px;
    height: 22px;
    cursor: pointer
  }
  /* positions */
  .olControlEditingToolbar {
    right: 0;
    top: 0;
  }
  .olControlNavToolbar {
    top: 295px;
    left: 9px;
  }
  /* layouts */
  .olControlEditingToolbar div {
    float: right;
  }
  /* individual controls */
  .olControlNavToolbar .olControlNavigationItemInactive,
  .olControlEditingToolbar .olControlNavigationItemInactive {
    background-position: -103px -1px;
  }
  .olControlNavToolbar .olControlNavigationItemActive ,
  .olControlEditingToolbar .olControlNavigationItemActive  {
    background-position: -103px -24px;
  }
  .olControlNavToolbar .olControlZoomBoxItemInactive {
    background-position: -128px -1px;
  }
  .olControlNavToolbar .olControlZoomBoxItemActive  {
    background-position: -128px -24px;
  }
  .olControlEditingToolbar .olControlDrawFeaturePointItemInactive {
    background-position: -77px -1px;
  }
  .olControlEditingToolbar .olControlDrawFeaturePointItemActive {
    background-position: -77px -24px;
  }
  .olControlEditingToolbar .olControlDrawFeaturePathItemInactive {
    background-position: -51px -1px;
  }
  .olControlEditingToolbar .olControlDrawFeaturePathItemActive {
    background-position: -51px -24px;
  }
  .olControlEditingToolbar .olControlDrawFeaturePolygonItemInactive{
    background-position: -26px -1px;
  }
  .olControlEditingToolbar .olControlDrawFeaturePolygonItemActive {
    background-position: -26px -24px;
  }

  div.olControlZoom {
    position: absolute;
    top: 8px;
    left: 8px;
    background: rgba(255,255,255,0.4);
    border-radius: 4px;
    padding: 2px;
  }
  div.olControlZoom a {
    display: block;
    margin: 1px;
    padding: 0;
    color: white;
    font-size: 18px;
    font-family: 'Lucida Grande', Verdana, Geneva, Lucida, Arial, Helvetica, sans-serif;
    font-weight: bold;
    text-decoration: none;
    text-align: center;
    height: 22px;
    width:22px;
    line-height: 19px;
    background: #130085; /* fallback for IE - IE6 requires background shorthand*/
    background: rgba(0, 60, 136, 0.5);
    filter: alpha(opacity=80);
  }
  div.olControlZoom a:hover {
    background: #130085; /* fallback for IE */
    background: rgba(0, 60, 136, 0.7);
    filter: alpha(opacity=100);
  }
  @media only screen and (max-width: 600px) {
    div.olControlZoom a:hover {
      background: rgba(0, 60, 136, 0.5);
    }
  }
  a.olControlZoomIn {
    border-radius: 4px 4px 0 0;
  }
  a.olControlZoomOut {
    border-radius: 0 0 4px 4px;
  }


  /**
   * Animations
   */

  .olLayerGrid .olTileImage {
    -webkit-transition: opacity 0.2s linear;
    -moz-transition: opacity 0.2s linear;
    -o-transition: opacity 0.2s linear;
    transition: opacity 0.2s linear;
  }

  /* Turn on GPU support where available */
  .olTileImage {
    -webkit-transform: translateZ(0);
    -moz-transform: translateZ(0);
    -o-transform: translateZ(0);
    -ms-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-backface-visibility: hidden;
    -moz-backface-visibility: hidden;
    -ms-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000;
    -moz-perspective: 1000;
    -ms-perspective: 1000;
    perspective: 1000;
  }

  /* when replacing tiles, do not show tile and backbuffer at the same time */
  .olTileReplacing {
    display: none;
  }

  /* override any max-width image settings (e.g. bootstrap.css) */
  img.olTileImage {
    max-width: none;
  }

  /* fix for non-loading tiles when overlay is on */
  svg {
    -webkit-transform: none !important;
  }
  .olTileImage {
    -webkit-backface-visibility: visible !important;
    -webkit-transform: none !important;
  }
</style>


<div class="ui inverted left  vertical  sidebar labeled icon menu">
  <a class="item" href="/">
    <i class="home icon"></i>
    <div class="content">
      <div class="header">HOME</div>
    </div>
  </a>
  <% @results.keys.each do |r| %>
      <a data-name="<%= @results[r][:link] %>"  data-content="<%=  type_description(@results[r][:type])[:description] %> - <%= @results[r][:link].split('_')[2..@results[r][:link].split('_').size].join(' ').capitalize %>" data-position="right center" class="  menu_popup <%= 'active' if @current && @current == r %> item" href="?xp=<%= @results[r][:link] %>">
        <i class="ui <%=   type_description(@results[r][:type])[:icon] %> icon"></i>
        <div class="content">
          <div class="header"> <%= r %></div>

        </div>
      </a>
  <% end %>

</div>

<div class="pusher">

  <div id="main" class="">
    <div class="ui main  container">
      <div class="ui inverted segment">
        <div class="ui inverted right attached rail">

          <div class="ui two buttons" style="padding-left: 5px;">
            <button id="xp_display"  class="ui basic grey labeled icon button">
              <i class="lab icon"></i>
              Select Xp
            </button>
            <button id="xp_reset"  class="ui basic grey right labeled icon button">
              <i class=" undo icon"></i>
              Reset
            </button>
          </div>
          <div class="ui inverted segment">

            <% if @current.nil? && @patterns.nil? %>
                <center><i>Please select an Xp to display the graph.</i></center>
                <div class="ui active inverted loader"></div>


            <% else %>
                <div class="ui inverted accordion">

                  <div class="title">
                    <i class="dropdown icon"></i>
                    Options
                  </div>
                  <div class="content">

                    <div id="controls">
                      <div id="controls-max" class="maximizeDiv olButton" style="position: absolute;"><img width="18" height="18" id="OpenLayers_Control_MaximizeDiv_innerImage" class="olAlphaImg" src="layer-switcher-maximize.png" style="position: relative;"></div>
                      <div id="controls-min" class="minimizeDiv olButton" style="position: absolute;"><img width="18" height="18" id="OpenLayers_Control_MinimizeDiv_innerImage" class="olAlphaImg" src="layer-switcher-minimize.png" style="position: relative;"></div>
                      <ul id="controlslist">
                        <b>Map Controls</b>
                        <li>
                          <input type="radio" name="type"
                                 value="none" id="noneToggle"
                                 onclick="toggleControl(this)"
                                 checked="checked" />
                          <label for="noneToggle">Navigate</label>
                        </li>
                        <li>
                          <input type="radio" name="type" value="line" id="lineToggle"
                                 onclick="toggleControl(this);" />
                          <label for="lineToggle">Measure Distance</label>
                        </li>
                        <li>
                          <input type="radio" name="type" value="circle" id="circleToggle"
                                 onclick="toggleControl(this);" />
                          <label for="circleToggle">Measure Circle</label>
                        </li>
                        <li>
                          <input type="radio" name="type" value="observerclick" id="observerToggle"
                                 onclick="toggleControl(this);" />
                          <label for="observerToggle">Place Observer Ward</label>
                        </li>
                        <li>
                          <input type="radio" name="type" value="sentryclick" id="sentryToggle"
                                 onclick="toggleControl(this);" />
                          <label for="sentryToggle">Place Sentry Ward</label>
                        </li>
                        </li>
                        <input type="checkbox" id="coordControl" checked=true/>
                        <label for="coordControl">Show Coordinates</label>
                        </li>
                      </ul>

                      <div id="output"></div>
                    </div>



                  </div>





                  <div class="title">
                    <i class="dropdown icon"></i>
                    Patterns: <%= @current %>
                  </div>
                  <div class="content">
                    <div class="transition hidden">
                      <table class="ui inverted very basic collapsing selectable table ">
                        <thead>
                        <tr>
                          <th>nb links</th>
                          <th>attr 1</th>
                          <th>attr 2</th>
                          <th>attr 3</th>
                          <th>attr 4</th>
                          <th>attr 5</th>
                          <th>attr 6</th>
                          <th>attr 7</th>
                          <th>attr 8</th>
                        </tr>
                        </thead>
                        <tbody>
                        <% @patterns.each_with_index do |pattern, index| %>
                            <tr data-index="<%= index %>">
                              <th><%= pattern[:links].size %></th>

                              <% pattern[:attrs].each do |attr| %>
                                  <th><%= attr %></th>
                              <% end %>
                            </tr>
                        <% end %>
                        </tbody>
                      </table>
                    </div>
                  </div>

                  <div id="patternContainer" class="title">
                    <i class="dropdown icon"></i>
                    Pattern: <%= @current %>
                  </div>
                  <div id="patternContainerContent" class="content">
                    Please Click a row in the Pattern's table to display attributes & path.
                  </div>



                </div>

            <% end %>


          </div>
        </div>

        <div id="graph_container">




          <div style="width:100%; height:100%" id="map"></div>

          <div id="coords" style="height: 1.5em;"></div>







        </div>
      </div>
    </div>
  </div>
</div>
<div class="ui small basic test modal transition hidden" style="margin-top: -123px;">
  <div class="ui icon header">
    <i class="trash icon"></i>
    Delete an Experience
  </div>
  <div class="content">
    <h3>Are you sure to want to delete this xp: </h3>
    - <strong><p id="xp_delete_name"></p></strong>
    <p id="xp_delete_description"></p>
  </div>
  <div class="actions">
    <div class="ui red basic cancel inverted button">
      <i class="remove icon"></i>
      No
    </div>
    <div class="ui green ok inverted button">
      <i class="checkmark icon"></i>
      Yes
    </div>
  </div>
</div>

<% unless @graph.nil? && @patterns.nil? %>
    <script type="text/javascript">
      var data = <%= @graph.to_json.to_s.html_safe %>;
      var patterns = <%= @patterns.to_json.to_s.html_safe %>;
    </script>

<% end %>

